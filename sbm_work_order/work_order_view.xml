<?xml version="1.0" encoding="UTF-8"?>
<openerp>
<data>
	<record model="ir.ui.view" id="sbm_work_order_tree">
		<field name="name">sbm.work.order.tree</field>
		<field name="model">sbm.work.order</field>
		<field name="type">tree</field>
		<field name="arch" type="xml">
			<tree string="ADHOC Order Request">
				<field name="wo_no"/>
				<field name="customer_id"/>
				<field name="customer_site_id"/>
				<field name="due_date"/>
				<field name="source_type"/>
				<field name="sale_order_id"/>
				<field name="adhoc_order_request_id"/>
				<field name="state"/>
			</tree>
		</field>
	</record>
    <record model="ir.ui.view" id="sbm_work_order_form">
	<field name="name">sbm.work.order.form</field>
	<field name="model">sbm.work.order</field>
    <field name="type">form</field>
    <field name="arch" type="xml">
    	<form string="WORK ORDER" version="7.0">
	        <header>
	            <field name="state" widget="statusbar" statusbar_visible="draft,confirmed,approved,approved2,validate,done"/>
        	</header>
        	<sheet>
        		<div class="oe_title">
					<h1>
						<label string="WORK ORDER"/>
						<separator string=""/>
						<field name="request_no" class="oe_inline" colspan="2"/>
						<field name="wo_no" class="oe_inline" colspan="2"/>
					</h1>
				</div>
        			<group col="4" colspan="4">
        				<group colspan="2">
        					<field name="source_type"/>
		            	 	<field name="sale_order_id" attrs="{'invisible':[('source_type', 'in', ['adhoc','internal_request'])], 'required':[('source_type', 'in', ['project','sale_order'])]}" on_change="sale_order_change(sale_order_id)"/>
		            	 	<field name="adhoc_order_request_id" attrs="{'invisible':[('source_type', '!=', 'adhoc')], 'required':[('source_type', '=', 'adhoc')]}"/>
		            	 	<field name="customer_id" context="{'search_default_customer':1, 'show_address': 1}" options="{&quot;always_reload&quot;: True}"/>
		            	 	<field name="customer_site_id" domain="[('parent_id', '=', customer_id)]" attrs="{'invisible':[('work_location', '!=', 'customersite')], 'required':[('work_location', '=', 'customersite')]}" context="{'search_default_customer':1, 'show_address': 1}" options="{&quot;always_reload&quot;: True}"/>
		            	 	<field name="location_id" attrs="{'invisible':[('work_location', '!=', 'workshop')], 'required':[('work_location', '=', 'workshop')]}"/>
        				</group>
        				<group colspan="2">
		            		<field name="work_location"/>
		            	 	<field name="due_date"/>
		            	 	<field name="order_date"/>
	            		</group>
	            	</group>
	            <notebook colspan="4">
	            	<page string="Output Picking">
	            		<field name="outputs">
	            			<tree>
	            				<field name="no"/>
	            				<field name="item_id"/>
	            				<field name="desc"/>
	            				<field name="qty"/>
	            				<field name="uom_id"/>
	            			</tree>
	            			<form string="Output Picking">
	            				<field name="item_id" colspan="4"/>
	            				<field name="desc" colspan="4"/>
	            				<field name="qty"/>
	            				<field name="uom_id"/>
	            				<field name="attachment_ids" colspan="4"  widget="many2many_binary" string="Attach a file"/>
		            				<notebook colspan="4">
											<page string="DATA MATERIAL">
												<field name="raw_materials" colspan="4" nolabel="1" widget="one2many_list">
													<tree string="Material Lines">
														<field name="item_id"/>
														<field name="desc" colspan="4"/>
														<field name="qty"/>
														<field name="uom_id"/>
														<field name="customer_material"/>
														<field name="adhoc_material_id"/>
													</tree>
												</field>
											</page>
											<page string="OUTPUT PICKING">
												<field name="output_picking_ids" colspan="4" nolabel="1" widget="one2many_list">
													<tree>
														<field name="work_order_output_id"/>
														<field name="work_order_id"/>
														<field name="picking_id"/>
													</tree>
													<form string="OUTPUT PICKING">
														<field name="work_order_output_id"/>
														<field name="work_order_id"/>
														<field name="picking_id"/>
															<notebook colspan="4">
																<page string="Move">
																	<field name="raw_material_moves" colspan="4" nolabel="1" widget="one2many_list">
																		<field name="move_id"/>
																		<field name="wo_raw_material_id"/>
																	</field>
																</page>
															</notebook>
													</form>
												</field>
											</page>
									</notebook>
	            			</form>
	            		</field>
	            	</page>
	            	<page string="Others">
	            		<group>
	            			<field name="repeat_ref_id"/>
	            		</group>
	            	</page>
	            </notebook>
        	</sheet>
    	</form>
    </field>
	</record>
	<record model="ir.actions.act_window" id="action_sbm_work_order">
		<field name="name">SBM Work Order</field>
		<field name="type">ir.actions.act_window</field>
		<field name="res_model">sbm.work.order</field>
		<field name="view_type">form</field>
		<field name="view_mode">tree,form</field>
	</record>


	<record id="seq_request_no" model="ir.sequence.type">
		<field name="name">Work Order Request No</field>
		<field name="code">sbm.work.order</field>
	</record>

	<record id="seq_sbm_work_order_req_no" model="ir.sequence">
		<field name="name">Work Order Request No</field>
		<field name="code">sbm.work.order</field>
		<!-- <field name="suffix">/</field> -->
		<field name="padding">5</field>
	</record>

<!-- 	<record id="seq_wo_no" model="ir.sequence.type">
		<field name="name">Work Order WO No</field>
		<field name="code">sbm.work.order</field>
	</record>

	<record id="seq_sbm_work_order_wo_no" model="ir.sequence">
		<field name="name">Work Order WO No</field>
		<field name="code">sbm.work.order</field>
		<field name="padding">5</field>
	</record> -->

	<menuitem id="sbm_work_order" name="Work Order" parent="base.menu_base_partner"/>

	<menuitem name="SBM Work Order" parent="sbm_work_order" id="sbm_work_order_request" action="action_sbm_work_order" sequence="2"/>

</data>
</openerp>